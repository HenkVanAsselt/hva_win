<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">

<!-- This HTML file generated by cxref. -->
<!-- cxref program (c) Andrew M. Bishop 1995,96,97,98,99. -->

<!--
Cxref: cxref -DHVA_WIN -Id:/djgpp/include -Odoc/cxref -xref-all -Nhva_win -index-all -html32 -html32-src genindex.c
CPP  : gcc -E -C -dD -dI -DHVA_WIN -Id:/djgpp/include
-->

<HTML>

<HEAD>
<TITLE>Source File genindex.c</TITLE>
</HEAD>

<BODY>

<pre>
<a name="line1">1    |</a> /**************************************************************************
<a name="line2">2    |</a> $Header: GENINDEX.C Fri 10-27-2000 9:37:26 pm HvA V2.01 $
<a name="line3">3    |</a> 
<a name="line4">4    |</a> HIST: 20001027 V2.01 - Adapted for DJGPP
<a name="line5">5    |</a> ***************************************************************************/
<a name="line6">6    |</a> 
<a name="line7">7    |</a> /************************************************************************
<a name="line8">8    |</a> *                                                                       *
<a name="line9">9    |</a> *  GENINDEX - Create index from text file.                              *
<a name="line10">10   |</a> *                                                                       *
<a name="line11">11   |</a> *  Support Program for The Window BOSS                                  *
<a name="line12">12   |</a> *                                                                       *
<a name="line13">13   |</a> *  Copyright (c) 1984,1985,1986 - Philip A. Mongelluzzo                 *
<a name="line14">14   |</a> *  All rights reserved.                                                 *
<a name="line15">15   |</a> *                                                                       *
<a name="line16">16   |</a> *  Note: The GENINDEX.EXE file was created using the CI86 compiler.     *
<a name="line17">17   |</a> *        If you attempt to recompile this program with either Lattice   *
<a name="line18">18   |</a> *        or MSC you may have to adjust the logic to account for the way *
<a name="line19">19   |</a> *        the various compilers treat &lt;CR&gt;&lt;LF&gt; sequences.  This usually  *
<a name="line20">20   |</a> *        amounts to nothing more than chaning the &quot;rb&quot; to &quot;r&quot; in the    *
<a name="line21">21   |</a> *        fopen statement.                                               *
<a name="line22">22   |</a> *                                                                       *
<a name="line23">23   |</a> *  History:                                                             *
<a name="line24">24   |</a> *                                                                       *
<a name="line25">25   |</a> *  911126 V0.2 - Generized subject heading key to the                   *
<a name="line26">26   |</a> *                sequence &quot;#%&quot; so this can be anywhere on               *
<a name="line27">27   |</a> *                a line                                                 *
<a name="line28">28   |</a> *  911127 V0.3 - Adjusted special characters to make a text-            *
<a name="line29">29   |</a> *                file which also can be used by 'HELPPC' (V2.10)        *
<a name="line30">30   |</a> *                                                                       *
<a name="line31">31   |</a> ************************************************************************/
<a name="line32">32   |</a> 
<a name="line33">33   |</a> /*------------------------------------------------------------------------
<a name="line34">34   |</a>   HelpPC text files are simple ASCII files that contain control codes
<a name="line35">35   |</a>   in column one.   Each file must contain a menu title in the first
<a name="line36">36   |</a>   line.  The remainder of the file consists of keyed lines and help
<a name="line37">37   |</a>   text.  Each line must end with a CR/LF pair (standard DOS format) and
<a name="line38">38   |</a>   shouldn't be longer than 79 characters.   Tabs position the text at
<a name="line39">39   |</a>   8 character tab positions.  The following is a list of keys and
<a name="line40">40   |</a>   special characters (keys are found in column 1, special characters
<a name="line41">41   |</a>   appear in columns 1-80):
<a name="line42">42   |</a> 
<a name="line43">43   |</a>    '@'  in column 1 indicates a file title which will appear in
<a name="line44">44   |</a>         the main topic menu.  This must be the very first line
<a name="line45">45   |</a>         in the file and has a maximum length of 40 characters
<a name="line46">46   |</a>         (excluding the '@').
<a name="line47">47   |</a>    ':'  in column 1 indicates a subtopic key.  Multiple keys separated
<a name="line48">48   |</a>         by colons ':' can be entered on the same line.  Single spaces
<a name="line49">49   |</a>         are allowed in a key, multiple spaces are compressed to single.
<a name="line50">50   |</a>    '%'  in column 1 indicates a highlighted title line.
<a name="line51">51   |</a>    '^'  in column 1 indicates a centered highlighted title.
<a name="line52">52   |</a>    ' '  (space) in column 1 indicates normal text.
<a name="line53">53   |</a>    '~'  Tilde is used to mark text as a subtopic link.  Use two
<a name="line54">54   |</a>         tilde characters to represent an actual tilde in the data.
<a name="line55">55   |</a>         A word or phrase enclosed between tilde's will become a
<a name="line56">56   |</a>         subtopic link for the current topic.
<a name="line57">57   |</a>    TAB  in column 1 starts text in column 9
<a name="line58">58   |</a>    any other character in column 1 is truncated
<a name="line59">59   |</a> 
<a name="line60">60   |</a>    Limits of the genindex() and help()
<a name="line61">61   |</a> 
<a name="line62">62   |</a>    Max items in main topic menu:          16
<a name="line63">63   |</a>    Max items in subtopic menu:           512
<a name="line64">64   |</a>    Max topics in index:                 1800
<a name="line65">65   |</a>    Max size of topic text:             16384 bytes
<a name="line66">66   |</a>    Max lines of text per topic:          512
<a name="line67">67   |</a>    Max topic key length:                  20
<a name="line68">68   |</a>    Max file title length:                 40
<a name="line69">69   |</a>    Max subtopic links:                   120
<a name="line70">70   |</a>    No limit on text file size
<a name="line71">71   |</a> 
<a name="line72">72   |</a> -----------------------------------------------------------------------*/
<a name="line73">73   |</a> 
<a name="line74">74   |</a> #include &lt;stdio.h&gt;                      /* Standard stuff */
<a name="line75">75   |</a> #include &lt;stdlib.h&gt;
<a name="line76">76   |</a> #include &lt;string.h&gt;
<a name="line77">77   |</a> #include &lt;ctype.h&gt;
<a name="line78">78   |</a> 
<a name="line79">79   |</a> #ifndef FALSE
<a name="line80">80   |</a> #define FALSE 0
<a name="line81">81   |</a> #define TRUE !FALSE
<a name="line82">82   |</a> #endif
<a name="line83">83   |</a> 
<a name="line84">84   |</a> /*#+func-------------------------------------------------------------------
<a name="line85">85   |</a>    FUNCTION: trimstr(char *s)
<a name="line86">86   |</a>     PURPOSE: Trim leading and trailing blanks of a string
<a name="line87">87   |</a>  DESRIPTION: -
<a name="line88">88   |</a>     RETURNS: TRUE if all OK, FALSE if it 's' is a NULL pointer
<a name="line89">89   |</a>     VERSION: 901101 V0.1
<a name="line90">90   |</a> --#-func-------------------------------------------------------------------*/
<a name="line91">91   |</a> int trimstr(char *s)
<a name="line92">92   |</a> {
<a name="line93">93   |</a>   int i;
<a name="line94">94   |</a> 
<a name="line95">95   |</a>   if (s == NULL)
<a name="line96">96   |</a>     return(FALSE);
<a name="line97">97   |</a> 
<a name="line98">98   |</a>   i = strlen(s);
<a name="line99">99   |</a>   if (i==0)
<a name="line100">100  |</a>     return(TRUE);
<a name="line101">101  |</a> 
<a name="line102">102  |</a>   while (isspace(s[--i]))       /* Delete trailing blanks */
<a name="line103">103  |</a>     s[i] = '\0';
<a name="line104">104  |</a> 
<a name="line105">105  |</a>   i = 0;                      /* Delete leading blanks */
<a name="line106">106  |</a>   while (isspace(s[i]))
<a name="line107">107  |</a>     i++;
<a name="line108">108  |</a>   strcpy(s,s+i);
<a name="line109">109  |</a> 
<a name="line110">110  |</a>   return(TRUE);
<a name="line111">111  |</a> }
<a name="line112">112  |</a> 
<a name="line113">113  |</a> /*#+func-------------------------------------------------------------------
<a name="line114">114  |</a>    FUNCTION: main()
<a name="line115">115  |</a>     PURPOSE: main function of 'GENINDEX.C'
<a name="line116">116  |</a>  DESRIPTION: -
<a name="line117">117  |</a>     RETURNS: Alway's returns 0
<a name="line118">118  |</a>     VERSION: 901101 V0.1
<a name="line119">119  |</a>              920205 V0.1 - Added trimstr() to trim topic key
<a name="line120">120  |</a> --#-func-------------------------------------------------------------------*/
<a name="line121">121  |</a> int main(int argc,char *argv[])
<a name="line122">122  |</a> {
<a name="line123">123  |</a>   FILE *fp;
<a name="line124">124  |</a>   FILE *fo;
<a name="line125">125  |</a>   char buf[132];
<a name="line126">126  |</a>   static char fname[132];
<a name="line127">127  |</a>   unsigned i;
<a name="line128">128  |</a>   long pos;
<a name="line129">129  |</a>   char *p;
<a name="line130">130  |</a>   char *token;
<a name="line131">131  |</a> 
<a name="line132">132  |</a>   if(argc &lt; 2)       /* check command line */
<a name="line133">133  |</a>   {
<a name="line134">134  |</a>     printf(&quot;Usage: genindex &lt;filename.ext&gt;&quot;);
<a name="line135">135  |</a>     exit(1);
<a name="line136">136  |</a>   }
<a name="line137">137  |</a> 
<a name="line138">138  |</a>   p = argv[1];      /* parse input filename */
<a name="line139">139  |</a>   i = 0;
<a name="line140">140  |</a>   while(*p) {
<a name="line141">141  |</a>     fname[i++] = *p++;
<a name="line142">142  |</a>     if(*p == ' ' || *p == '.') break;
<a name="line143">143  |</a>   }
<a name="line144">144  |</a>   strcat(fname, &quot;.ndx&quot;);                /* create output filename */
<a name="line145">145  |</a> 
<a name="line146">146  |</a>   fp = fopen(argv[1], &quot;r&quot;);             /* open input */
<a name="line147">147  |</a>   if(!fp) {
<a name="line148">148  |</a>     printf(&quot;Open failed: %s&quot;, argv[1]);
<a name="line149">149  |</a>     exit(1);
<a name="line150">150  |</a>   }
<a name="line151">151  |</a>   printf(&quot;Creating: %s\n&quot;, fname);        /* say whats going on */
<a name="line152">152  |</a>   fo = fopen(fname, &quot;w&quot;);                 /* open output */
<a name="line153">153  |</a> 
<a name="line154">154  |</a>   while(fgets(&amp;buf[0],132,fp))            /* read lines till eof */
<a name="line155">155  |</a>   {
<a name="line156">156  |</a>     /*-------------------------------------------
<a name="line157">157  |</a>       Check if this line starts with a topic key
<a name="line158">158  |</a>     ---------------------------------------------*/
<a name="line159">159  |</a>     if(buf[0] == ':')                     /* look for topic key  */
<a name="line160">160  |</a>     {
<a name="line161">161  |</a>       token = strtok(buf,&quot;:\n\r&quot;);
<a name="line162">162  |</a>       trimstr(token);
<a name="line163">163  |</a>       while (token)
<a name="line164">164  |</a>       {
<a name="line165">165  |</a>         pos = ftell(fp);                        /* get file position */
<a name="line166">166  |</a>         fprintf(fo,&quot;%s\n%ld\n&quot;,token,pos);      /* write to index file */
<a name="line167">167  |</a>         fprintf(stdout,&quot;%s\n%ld\n&quot;,token,pos);  /* display on console */
<a name="line168">168  |</a>         token = strtok(NULL,&quot;:\n\r&quot;);           /* Look for next subtopic key */
<a name="line169">169  |</a>       }
<a name="line170">170  |</a>     }
<a name="line171">171  |</a> 
<a name="line172">172  |</a>   }
<a name="line173">173  |</a>   fclose(fp);                             /* close files */
<a name="line174">174  |</a>   fclose(fo);
<a name="line175">175  |</a>   return(0);
<a name="line176">176  |</a> }
<a name="line177">177  |</a> 
</pre>

</BODY>
</HTML>
