<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>HVA-WIN: funkey.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>funkey.c</h1><a href="funkey_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">$Header: FUNKEY.C Fri 10-27-2000 9:26:44 pm HvA V2.01 $</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">DESC: function key handling for HVA_WIN</span>
<a name="l00005"></a>00005 <span class="comment">HIST: 19911223 V1.00</span>
<a name="l00006"></a>00006 <span class="comment">          20001027 V2.01 - Adapted for DJGPP</span>
<a name="l00007"></a>00007 <span class="comment">***************************************************************************/</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="comment">/****************************************************************************</span>
<a name="l00010"></a>00010 <span class="comment">*              Function keys handled are:       F1...F10                    *</span>
<a name="l00011"></a>00011 <span class="comment">*                                         SHIFT_F1...SHIFT_F10              *</span>
<a name="l00012"></a>00012 <span class="comment">*                                           ALT_F1...ALT_F10                *</span>
<a name="l00013"></a>00013 <span class="comment">*                                          CTRL_F1...CTRL_F10               *</span>
<a name="l00014"></a>00014 <span class="comment">****************************************************************************/</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">/*---------------------------------------------------------------------------</span>
<a name="l00017"></a>00017 <span class="comment">                        HEADER FILES</span>
<a name="l00018"></a>00018 <span class="comment">---------------------------------------------------------------------------*/</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;conio.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;dos.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include "<a class="code" href="keys_8h.html">keys.h</a>"</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include "video/v_video.h"</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "<a class="code" href="window_8h.html">window.h</a>"</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">extern</span> SCREEN <a class="code" href="appl_8c.html#8573f78b328d6c8a4ab7f64db3ce1c45">_cursvar</a>;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment">/*---------------------------------------------------------------------------</span>
<a name="l00033"></a>00033 <span class="comment">                        PROTOTYPES</span>
<a name="l00034"></a>00034 <span class="comment">---------------------------------------------------------------------------*/</span>
<a name="l00035"></a><a class="code" href="struct_f_u_n_c_t_i_o_n___h_a_n_d_l_e_r.html">00035</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00036"></a>00036 {
<a name="l00037"></a><a class="code" href="struct_f_u_n_c_t_i_o_n___h_a_n_d_l_e_r.html#3e8db967e672346352758b085e40f85c">00037</a>   <span class="keywordtype">void</span> *function;       <span class="comment">/* Function to perform */</span>
<a name="l00038"></a><a class="code" href="struct_f_u_n_c_t_i_o_n___h_a_n_d_l_e_r.html#9e454a9086e53245e3c22b89083929c1">00038</a>   <span class="keywordtype">char</span> *text;           <span class="comment">/* Text on line        */</span>
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 <a class="code" href="struct_f_u_n_c_t_i_o_n___h_a_n_d_l_e_r.html">FUNCTION_HANDLER</a>;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="comment">// static void init_keylabels(void);</span>
<a name="l00043"></a>00043 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="funkey_8c.html#d4535da47d531a01af51f8e1f668f71b">func_index</a>(<span class="keywordtype">int</span> function_key);
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">/*---------------------------------------------------------------------------</span>
<a name="l00046"></a>00046 <span class="comment">                        CONSTANTS</span>
<a name="l00047"></a>00047 <span class="comment">---------------------------------------------------------------------------*/</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">/*---------------------------------------------------------------------------</span>
<a name="l00050"></a>00050 <span class="comment">                        LOCAL VARIABLES</span>
<a name="l00051"></a>00051 <span class="comment">---------------------------------------------------------------------------*/</span>
<a name="l00052"></a><a class="code" href="funkey_8c.html#1786668fb7644c3d46b73e4e387d8721">00052</a> <span class="keyword">static</span> <a class="code" href="structwcb.html">WINDOW</a> *<a class="code" href="editstr_8c.html#1786668fb7644c3d46b73e4e387d8721">w</a> = NULL;
<a name="l00053"></a><a class="code" href="funkey_8c.html#2671827b6c4d9797278dee2e726ca446">00053</a> <span class="keyword">static</span> <a class="code" href="struct_f_u_n_c_t_i_o_n___h_a_n_d_l_e_r.html">FUNCTION_HANDLER</a> <a class="code" href="funkey_8c.html#2671827b6c4d9797278dee2e726ca446">funkey</a>[40];
<a name="l00054"></a><a class="code" href="funkey_8c.html#1885434eb8cac868c4cb88426049e3f0">00054</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="funkey_8c.html#1885434eb8cac868c4cb88426049e3f0">show_funkeys</a> = <a class="code" href="4dos_8c.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">/*</span>
<a name="l00057"></a>00057 <span class="comment">#define TESTING</span>
<a name="l00058"></a>00058 <span class="comment">*/</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">/*===========================================================================</span>
<a name="l00061"></a>00061 <span class="comment">                        START OF FUNCTIONS</span>
<a name="l00062"></a>00062 <span class="comment">===========================================================================*/</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="comment">/*#+func---------------------------------------------------------------------</span>
<a name="l00065"></a>00065 <span class="comment">    FUNCTION: func_index()</span>
<a name="l00066"></a>00066 <span class="comment">     PURPOSE: Calculate index of a function key</span>
<a name="l00067"></a>00067 <span class="comment"> DESCRIPTION: -</span>
<a name="l00068"></a>00068 <span class="comment">     RETURNS: Calculated index to the array of function handlers</span>
<a name="l00069"></a>00069 <span class="comment">     HISTORY: 911224 V0.1</span>
<a name="l00070"></a>00070 <span class="comment">--#-func-------------------------------------------------------------------*/</span>
<a name="l00071"></a><a class="code" href="funkey_8c.html#d4535da47d531a01af51f8e1f668f71b">00071</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="funkey_8c.html#d4535da47d531a01af51f8e1f668f71b">func_index</a>(<span class="keywordtype">int</span> function_key)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   <span class="keywordtype">int</span> ndx;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   <span class="keywordflow">switch</span> (function_key)
<a name="l00076"></a>00076   {
<a name="l00077"></a>00077     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#54af470c198f3dbe32eede2c32f3d746">F1</a>:
<a name="l00078"></a>00078     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#5368759862ac5fb38772b91eace1205c">F2</a>:
<a name="l00079"></a>00079     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#79fc770a19406e6876ff9ffd6ce66f3d">F3</a>:
<a name="l00080"></a>00080     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#7fd7918aa90b0ce1dc7ca9fe7a00e9fb">F4</a>:
<a name="l00081"></a>00081     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#33a001184d6e389fd20132f7c21cf8ca">F5</a>:
<a name="l00082"></a>00082     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#dcc6c65566433e67172e375586cdb0f7">F6</a>:
<a name="l00083"></a>00083     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#7c9b5c379fad716fab5e7d1d6e627d6b">F7</a>:
<a name="l00084"></a>00084     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#ebf0bdb7cd47b4d4c612c2cadee1a743">F8</a>:
<a name="l00085"></a>00085     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#36ff4eb644bddf74a8ac0102ea21fb1e">F9</a>:
<a name="l00086"></a>00086     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#9ba8300113c516255f356f9bd121c518">F10</a>:
<a name="l00087"></a>00087       ndx = function_key-<a class="code" href="keys_8h.html#54af470c198f3dbe32eede2c32f3d746">F1</a>;
<a name="l00088"></a>00088       <span class="keywordflow">break</span>;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#1a86190463962e0f75f81f3d527a78f7">SHIFT_F1</a>:
<a name="l00091"></a>00091     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#5d320e642e311a721f0dfb16378f534a">SHIFT_F2</a>:
<a name="l00092"></a>00092     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#444f207e7c35f3907089280289a8be48">SHIFT_F3</a>:
<a name="l00093"></a>00093     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#4408efabb3f1a4b8e52a30010191d826">SHIFT_F4</a>:
<a name="l00094"></a>00094     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#ad3d548c7396e63c008bef1b6f27680e">SHIFT_F5</a>:
<a name="l00095"></a>00095     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#c790d88f4e621db4917d996352f44db5">SHIFT_F6</a>:
<a name="l00096"></a>00096     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#b26f43a5269d7e4b9fa4fb79d4f2c55d">SHIFT_F7</a>:
<a name="l00097"></a>00097     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#e3ff1df907660a278250e8b9820f15fb">SHIFT_F8</a>:
<a name="l00098"></a>00098     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#cb4449343d1de655e438413088b676fe">SHIFT_F9</a>:
<a name="l00099"></a>00099     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#43edf21e4044efd70866759f17c34e23">SHIFT_F10</a>:
<a name="l00100"></a>00100       ndx = function_key - <a class="code" href="keys_8h.html#1a86190463962e0f75f81f3d527a78f7">SHIFT_F1</a> + 10;
<a name="l00101"></a>00101       <span class="keywordflow">break</span>;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#0a8745a71f575230fc43c0ff32442647">CTRL_F1</a>:
<a name="l00104"></a>00104     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#2006ec0dfec171bb0b7470d3f97c4c4a">CTRL_F2</a>:
<a name="l00105"></a>00105     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#233fcd4065e8d03356879b5636876510">CTRL_F3</a>:
<a name="l00106"></a>00106     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#18e6d40daf568d8fb2f5b72e01f5cabe">CTRL_F4</a>:
<a name="l00107"></a>00107     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#c75a42c4cff559b2760448e9c32a54f4">CTRL_F5</a>:
<a name="l00108"></a>00108     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#976a88f1fdf2c3cbafe2a3726abaca0c">CTRL_F6</a>:
<a name="l00109"></a>00109     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#65141b4ab9dfc329b235e38c63d9197d">CTRL_F7</a>:
<a name="l00110"></a>00110     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#ac04cebd9b52eb87f4e8cd1b6994dc9c">CTRL_F8</a>:
<a name="l00111"></a>00111     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#315f8dda4ae59d004b3d2d5dc37f5898">CTRL_F9</a>:
<a name="l00112"></a>00112     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#1b2ffbb3450fa933fcccba008cdb8d34">CTRL_F10</a>:
<a name="l00113"></a>00113       ndx = function_key - <a class="code" href="keys_8h.html#0a8745a71f575230fc43c0ff32442647">CTRL_F1</a> + 20;
<a name="l00114"></a>00114       <span class="keywordflow">break</span>;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#8e915b7b2b801796ed5184ba60fdeec7">ALT_F1</a>:
<a name="l00117"></a>00117     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#7b5fbb3bbf213b1faed0cd7515d947a2">ALT_F2</a>:
<a name="l00118"></a>00118     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#19a20ad17257138b3cd97f1da2edc975">ALT_F3</a>:
<a name="l00119"></a>00119     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#ffe86a4505b30469539a8a8601338740">ALT_F4</a>:
<a name="l00120"></a>00120     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#e3416a35d19aed79bffea9532c5cc38b">ALT_F5</a>:
<a name="l00121"></a>00121     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#f63929c65dd7d54775869f0fbc6d05a0">ALT_F6</a>:
<a name="l00122"></a>00122     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#140a9b8463fdd03c342af48e7cdcf58e">ALT_F7</a>:
<a name="l00123"></a>00123     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#5bf883cf2d66bc70542ba072bbea955f">ALT_F8</a>:
<a name="l00124"></a>00124     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#b7995ce4392caee6cfb3603679dea358">ALT_F9</a>:
<a name="l00125"></a>00125     <span class="keywordflow">case</span> <a class="code" href="keys_8h.html#cca4824445df08bef92264cb0410ecad">ALT_F10</a>:
<a name="l00126"></a>00126       ndx = function_key - <a class="code" href="keys_8h.html#8e915b7b2b801796ed5184ba60fdeec7">ALT_F1</a> + 30;
<a name="l00127"></a>00127       <span class="keywordflow">break</span>;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <span class="keywordflow">default</span>:
<a name="l00130"></a>00130 <span class="preprocessor">      #ifdef TESTING</span>
<a name="l00131"></a>00131 <span class="preprocessor"></span>        <a class="code" href="window_8h.html#e057cb905d61d5fa63d9cc0e5549f389">wn_error</a>(<span class="stringliteral">"Wrong function key %d in init_funct_Fx()"</span>,function_key);
<a name="l00132"></a>00132 <span class="preprocessor">      #endif</span>
<a name="l00133"></a>00133 <span class="preprocessor"></span>      <span class="keywordflow">return</span>(-1);
<a name="l00134"></a>00134   }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="keywordflow">return</span>(ndx);
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">/*#+func---------------------------------------------------------------------</span>
<a name="l00140"></a>00140 <span class="comment">    FUNCTION: init_funkey()</span>
<a name="l00141"></a>00141 <span class="comment">     PURPOSE: Initialize a function key</span>
<a name="l00142"></a>00142 <span class="comment"> DESCRIPTION: -</span>
<a name="l00143"></a>00143 <span class="comment">     RETURNS: nothing</span>
<a name="l00144"></a>00144 <span class="comment">     HISTORY: 911224 V0.1</span>
<a name="l00145"></a>00145 <span class="comment">--#-func-------------------------------------------------------------------*/</span>
<a name="l00146"></a><a class="code" href="window_8h.html#725f0cac5cb693076b7811c887e733b4">00146</a> <span class="keywordtype">void</span> <a class="code" href="funkey_8c.html#725f0cac5cb693076b7811c887e733b4">init_funkey</a>(<span class="keywordtype">int</span> function_key, <span class="keywordtype">void</span> *function, <span class="keywordtype">char</span> *text)
<a name="l00147"></a>00147 {
<a name="l00148"></a>00148   <span class="keywordtype">int</span> ndx;
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   <a class="code" href="window_8h.html#fe8d4f2504094ff6d3e433214a324fe0">wn_log</a>(<span class="stringliteral">"init_funkey(key=%d,function=%p,text=%s\n"</span>,
<a name="l00151"></a>00151     function_key, function, text);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153   <span class="comment">/*-------------------------------</span>
<a name="l00154"></a>00154 <span class="comment">    Initialize funkey[] variables</span>
<a name="l00155"></a>00155 <span class="comment">  ---------------------------------*/</span>
<a name="l00156"></a>00156   ndx = <a class="code" href="funkey_8c.html#d4535da47d531a01af51f8e1f668f71b">func_index</a>(function_key);       <span class="comment">/* Calculate index to array         */</span>
<a name="l00157"></a>00157   funkey[ndx].<a class="code" href="struct_f_u_n_c_t_i_o_n___h_a_n_d_l_e_r.html#3e8db967e672346352758b085e40f85c">function</a> = function;      <span class="comment">/* Copy pointer to funkey function  */</span>
<a name="l00158"></a>00158   <span class="keywordflow">if</span> (strlen(text) &gt; 6) text[6] = <span class="charliteral">'\0'</span>; <span class="comment">/* Check if text is not to long     */</span>
<a name="l00159"></a>00159   funkey[ndx].<a class="code" href="struct_f_u_n_c_t_i_o_n___h_a_n_d_l_e_r.html#9e454a9086e53245e3c22b89083929c1">text</a>     = text;          <span class="comment">/* Copy pointer to funkey text      */</span>
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">/*#+func---------------------------------------------------------------------</span>
<a name="l00164"></a>00164 <span class="comment">    FUNCTION: do_funkey()</span>
<a name="l00165"></a>00165 <span class="comment">     PURPOSE: Perform function, assigned to the function key</span>
<a name="l00166"></a>00166 <span class="comment">      SYNTAX: int do_funkey(int key);</span>
<a name="l00167"></a>00167 <span class="comment">              int key : code of (function) key to perform function on</span>
<a name="l00168"></a>00168 <span class="comment"> DESCRIPTION:</span>
<a name="l00169"></a>00169 <span class="comment">     RETURNS: 0 if function performed (function available)</span>
<a name="l00170"></a>00170 <span class="comment">              function_key if no function performed</span>
<a name="l00171"></a>00171 <span class="comment">     HISTORY: 911224 V0.1</span>
<a name="l00172"></a>00172 <span class="comment">--#-func-------------------------------------------------------------------*/</span>
<a name="l00173"></a><a class="code" href="window_8h.html#11b440de276115198ecce926a671d27d">00173</a> <span class="keywordtype">int</span> <a class="code" href="funkey_8c.html#f91392e8cfb8d94ac95b3de6bd0da109">do_funkey</a>(<span class="keywordtype">int</span> key)
<a name="l00174"></a>00174 {
<a name="l00175"></a>00175   <span class="keywordtype">int</span> ndx;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <a class="code" href="window_8h.html#fe8d4f2504094ff6d3e433214a324fe0">wn_log</a>(<span class="stringliteral">"do_funkey(key=%2d)\n"</span>);
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   <span class="keywordflow">if</span> (<a class="code" href="keys_8c.html#ec781f8aa4d29c408a105f3bf9cf8486">is_fkey</a>(key)) {
<a name="l00180"></a>00180     ndx = <a class="code" href="funkey_8c.html#d4535da47d531a01af51f8e1f668f71b">func_index</a>(key);                <span class="comment">/* Find array index       */</span>
<a name="l00181"></a>00181     <span class="keywordflow">if</span> (funkey[ndx].function) {           <span class="comment">/* If function defined    */</span>
<a name="l00182"></a>00182       (*(<a class="code" href="window_8h.html#80937367c25c0da8073d154502cf6310">PFI</a>)(funkey[ndx].function))();   <span class="comment">/* then execute function  */</span>
<a name="l00183"></a>00183       <span class="keywordflow">return</span>(0);
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185     <span class="keywordflow">else</span>
<a name="l00186"></a>00186       <span class="keywordflow">return</span>(key);
<a name="l00187"></a>00187   }
<a name="l00188"></a>00188   <span class="keywordflow">else</span>
<a name="l00189"></a>00189     <span class="keywordflow">return</span>(key);
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="comment">/*#+func---------------------------------------------------------------------</span>
<a name="l00194"></a>00194 <span class="comment">    FUNCTION: disp_funkeys()</span>
<a name="l00195"></a>00195 <span class="comment">     PURPOSE: Display function keys on screen</span>
<a name="l00196"></a>00196 <span class="comment"> DESCRIPTION: Display function keys in lower 4 lines of display</span>
<a name="l00197"></a>00197 <span class="comment">              0 = Hide function key display</span>
<a name="l00198"></a>00198 <span class="comment">              1 = normal function keys</span>
<a name="l00199"></a>00199 <span class="comment">              2 = shifted function keys</span>
<a name="l00200"></a>00200 <span class="comment">              3 = CTRL function keys</span>
<a name="l00201"></a>00201 <span class="comment">              4 = ALT function keys</span>
<a name="l00202"></a>00202 <span class="comment">     RETURNS: nothing</span>
<a name="l00203"></a>00203 <span class="comment">     HISTORY: 911224 V0.1</span>
<a name="l00204"></a>00204 <span class="comment">--#-func-------------------------------------------------------------------*/</span>
<a name="l00205"></a><a class="code" href="window_8h.html#6cc6361e13b96d7a3cbea9dcea7f6cdb">00205</a> <span class="keywordtype">void</span> <a class="code" href="funkey_8c.html#6cc6361e13b96d7a3cbea9dcea7f6cdb">disp_funkeys</a>(<span class="keywordtype">int</span> i)
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207   <span class="keywordtype">int</span> j;
<a name="l00208"></a>00208   <span class="keywordtype">int</span> <a class="code" href="dir_8c.html#f1d3cff2e4538e23400e260bae3dadad">row</a>,<a class="code" href="dir_8c.html#fb52e720f5f0c483db5861f9e42e924e">col</a>;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210   <a class="code" href="funkey_8c.html#1885434eb8cac868c4cb88426049e3f0">show_funkeys</a> = <a class="code" href="4dos_8c.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212   <span class="keywordflow">if</span> (i&lt;0 || i&gt;4)
<a name="l00213"></a>00213   {
<a name="l00214"></a>00214     <a class="code" href="window_8h.html#fe8d4f2504094ff6d3e433214a324fe0">wn_log</a>(<span class="stringliteral">"wrong index %d in disp_funkeys\n"</span>,i);
<a name="l00215"></a>00215     i = 1;
<a name="l00216"></a>00216   }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <span class="comment">/*--------------------------------------</span>
<a name="l00219"></a>00219 <span class="comment">    Check if we have to open a window for</span>
<a name="l00220"></a>00220 <span class="comment">    the function keys, or if this window</span>
<a name="l00221"></a>00221 <span class="comment">    has already been opened.</span>
<a name="l00222"></a>00222 <span class="comment">    The window will occupy the last row on</span>
<a name="l00223"></a>00223 <span class="comment">    the screen with a full length</span>
<a name="l00224"></a>00224 <span class="comment">  ----------------------------------------*/</span>
<a name="l00225"></a>00225   <span class="keywordflow">if</span> (!w)
<a name="l00226"></a>00226   {
<a name="l00227"></a>00227     <a class="code" href="window_8h.html#fe8d4f2504094ff6d3e433214a324fe0">wn_log</a>(<span class="stringliteral">"*** START FUNKEY\n"</span>);
<a name="l00228"></a>00228     w = <a class="code" href="window_8c.html#d1ddc54b76a18f41e2aeb897e8ac4a71">wn_open</a>(<a class="code" href="window_8h.html#50ef1b505da36053c2c41333a89ece6d">_NO_BORDER</a>,<a class="code" href="appl_8c.html#8573f78b328d6c8a4ab7f64db3ce1c45">_cursvar</a>.lines,0,<a class="code" href="appl_8c.html#8573f78b328d6c8a4ab7f64db3ce1c45">_cursvar</a>.cols+1,1,<a class="code" href="window_8h.html#b66205319a0b6e2ba7deb80d7211ff04">_menu_att</a>,<a class="code" href="window_8h.html#b66205319a0b6e2ba7deb80d7211ff04">_menu_att</a>);
<a name="l00229"></a>00229     <a class="code" href="window_8h.html#2771a71e9c3c0b4aff6dd2966519b82e">wn_clear</a>(w);
<a name="l00230"></a>00230   }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232   <span class="comment">/*------------------------------------------------</span>
<a name="l00233"></a>00233 <span class="comment">    Check if user wants to hide function key labels</span>
<a name="l00234"></a>00234 <span class="comment">    or to display it</span>
<a name="l00235"></a>00235 <span class="comment">  --------------------------------------------------*/</span>
<a name="l00236"></a>00236   <span class="keywordflow">if</span> (i==0)
<a name="l00237"></a>00237   {
<a name="l00238"></a>00238     <a class="code" href="funkey_8c.html#1885434eb8cac868c4cb88426049e3f0">show_funkeys</a> = <a class="code" href="4dos_8c.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00239"></a>00239     <a class="code" href="window_8c.html#83d79805ed6b09849c1345ebafb46104">wn_hide</a>(w);
<a name="l00240"></a>00240     <span class="keywordflow">return</span>;
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242   <span class="keywordflow">else</span> {
<a name="l00243"></a>00243     <span class="keywordflow">if</span> (<a class="code" href="funkey_8c.html#1885434eb8cac868c4cb88426049e3f0">show_funkeys</a> == <a class="code" href="4dos_8c.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>) {
<a name="l00244"></a>00244       <a class="code" href="funkey_8c.html#1885434eb8cac868c4cb88426049e3f0">show_funkeys</a> = <a class="code" href="4dos_8c.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00245"></a>00245       <span class="keywordflow">if</span> (w)
<a name="l00246"></a>00246         <a class="code" href="window_8c.html#7b681dbd1d7921848e18edb4cbcf5b8c">wn_unhide</a>(w);
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250   <span class="comment">/*-------------------------</span>
<a name="l00251"></a>00251 <span class="comment">    Print the function keys</span>
<a name="l00252"></a>00252 <span class="comment">  --------------------------*/</span>
<a name="l00253"></a>00253   row = 0;
<a name="l00254"></a>00254   col = 0;
<a name="l00255"></a>00255   <span class="keywordflow">for</span> (j = 0 ; j&lt;10 ; j++)
<a name="l00256"></a>00256   {
<a name="l00257"></a>00257     <a class="code" href="window_8h.html#13cebd785636ae2168a46520c9ca50c2">wn_locate</a>(w,row,col);
<a name="l00258"></a>00258     <span class="keywordflow">if</span> (funkey[j].text) {
<a name="l00259"></a>00259       <a class="code" href="window_8h.html#2d6ad4e99d2d92e976658225ba7a5565">wn_printf</a>(w,<span class="stringliteral">"%1d%-6.6s"</span>,j+1,funkey[j].text);
<a name="l00260"></a>00260       <a class="code" href="window_8c.html#69200e4cc96434712cdb487ed16f13df">wn_setone</a>(w,row,col,<a class="code" href="window_8h.html#4bf4b89ae0836cff55525f9dbc0a45a1">_menu_hotkey</a>);
<a name="l00261"></a>00261       <span class="keywordflow">if</span> (j==9)
<a name="l00262"></a>00262        <a class="code" href="window_8c.html#69200e4cc96434712cdb487ed16f13df">wn_setone</a>(w,row,col+1,<a class="code" href="window_8h.html#4bf4b89ae0836cff55525f9dbc0a45a1">_menu_hotkey</a>);
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264     col+=7;
<a name="l00265"></a>00265   }
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">/*#+func---------------------------------------------------------------------</span>
<a name="l00269"></a>00269 <span class="comment">    FUNCTION: exit_funkey()</span>
<a name="l00270"></a>00270 <span class="comment">     PURPOSE: Exit the funkey routine</span>
<a name="l00271"></a>00271 <span class="comment"> DESCRIPTION: Closes the function key window</span>
<a name="l00272"></a>00272 <span class="comment">     RETURNS: nothing</span>
<a name="l00273"></a>00273 <span class="comment">     HISTORY: 920107 V0.1 - Initial version</span>
<a name="l00274"></a>00274 <span class="comment">--#-func--------------------------------------------------------------------*/</span>
<a name="l00275"></a><a class="code" href="window_8h.html#929cfc6e997cb7b59c301bbf07bed083">00275</a> <span class="keywordtype">void</span> <a class="code" href="funkey_8c.html#a9e306422f02788dedff0bf33296e7cc">exit_funkey</a>()
<a name="l00276"></a>00276 {
<a name="l00277"></a>00277   <span class="keywordflow">if</span> (w)
<a name="l00278"></a>00278   {
<a name="l00279"></a>00279     <a class="code" href="window_8h.html#fe8d4f2504094ff6d3e433214a324fe0">wn_log</a>(<span class="stringliteral">"*** END FUNKEY\n"</span>);
<a name="l00280"></a>00280     w = <a class="code" href="window_8c.html#66cf8230f2298dcc91a3d8ce52bd4475">wn_close</a>(w);
<a name="l00281"></a>00281   }
<a name="l00282"></a>00282 }
</pre></div><hr size="1"><address style="text-align: right;"><small>Generated on Fri Dec 14 21:49:24 2007 for HVA-WIN by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
